---
phase: 03-playable-grid
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/midi/ChromaticPalette.h
  - src/ui/PadComponent.h
  - src/ui/PadComponent.cpp
  - src/ui/GridPanel.h
  - src/ui/GridPanel.cpp
  - src/ui/ChordPumperLookAndFeel.h
  - src/ui/PluginEditor.h
  - src/ui/PluginEditor.cpp
  - CMakeLists.txt
autonomous: true
requirements: [GRID-01, GRID-02]

must_haves:
  truths:
    - "User sees 32 labeled chord pads in an 8×4 grid layout in the plugin window"
    - "Each pad displays its chord name (e.g. C, Am, Fdim, Caug)"
    - "Grid displays a chromatic palette: 12 major, 12 minor, 4 diminished, 4 augmented"
    - "Pads respond visually to mouse hover (brighter) and press (accent colour)"
  artifacts:
    - path: "src/midi/ChromaticPalette.h"
      provides: "Static 32-chord palette function"
      contains: "chromaticPalette"
    - path: "src/ui/PadComponent.h"
      provides: "Single chord pad component declaration"
      exports: ["PadComponent"]
    - path: "src/ui/PadComponent.cpp"
      provides: "Pad painting (rounded rect, chord name) and mouse handling"
      min_lines: 40
    - path: "src/ui/GridPanel.h"
      provides: "8×4 grid container declaration"
      exports: ["GridPanel"]
    - path: "src/ui/GridPanel.cpp"
      provides: "Grid layout via juce::Grid and pad population from palette"
      min_lines: 25
  key_links:
    - from: "src/ui/GridPanel.cpp"
      to: "src/midi/ChromaticPalette.h"
      via: "chromaticPalette() called in constructor to populate 32 pads"
      pattern: "chromaticPalette"
    - from: "src/ui/PadComponent.cpp"
      to: "src/engine/Chord.h"
      via: "chord.name() for label text in paint()"
      pattern: "chord\\.name\\(\\)"
    - from: "src/ui/PluginEditor.cpp"
      to: "src/ui/GridPanel.h"
      via: "gridPanel member owned by editor, laid out in resized()"
      pattern: "gridPanel"
---

<objective>
Create the visual 8×4 chord pad grid with chromatic palette, producing a visible UI that satisfies GRID-01 and GRID-02.

Purpose: Users need to see 32 labeled chord pads as the foundation for playable MIDI output (wired in Plan 02).
Output: Five new source files (ChromaticPalette.h, PadComponent.h/.cpp, GridPanel.h/.cpp), updated PluginEditor showing the grid, updated CMakeLists.txt.
</objective>

<execution_context>
@~/.cursor/get-shit-done/workflows/execute-plan.md
@~/.cursor/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-playable-grid/03-RESEARCH.md

@src/engine/Chord.h
@src/engine/PitchClass.h
@src/engine/ChordType.h
@src/engine/NoteLetter.h
@src/ui/PluginEditor.h
@src/ui/PluginEditor.cpp
@src/ui/ChordPumperLookAndFeel.h
@src/PluginProcessor.h
@CMakeLists.txt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ChromaticPalette and PadComponent</name>
  <files>
    src/midi/ChromaticPalette.h
    src/ui/PadComponent.h
    src/ui/PadComponent.cpp
  </files>
  <action>
    Create `src/midi/ChromaticPalette.h` — header-only, in namespace chordpumper.
    Include `engine/Chord.h`. Define `inline std::array<Chord, 32> chromaticPalette()` returning:
    - Row 0 (indices 0–7): C, C#, D, Eb, E, F, F#, G — all Major
    - Row 1 (indices 8–15): Ab, A, Bb, B Major, then C, C#, D, Eb Minor
    - Row 2 (indices 16–23): E, F, F#, G, Ab, A, Bb, B — all Minor
    - Row 3 (indices 24–31): C dim, D dim, E dim, F# dim, C aug, Eb aug, G aug, Bb aug
    Use `pitches::` constants and `ChordType::` enum from existing engine.
    Match the exact palette from 03-RESEARCH.md Pattern 5.

    Create `src/ui/PadComponent.h` — in namespace chordpumper.
    Include `engine/Chord.h`, `<juce_gui_basics/juce_gui_basics.h>`, `<functional>`.
    Class PadComponent : public juce::Component.
    Public members:
    - `void setChord(const Chord& c)` — stores chord, calls repaint
    - `const Chord& getChord() const`
    - `std::function<void(const Chord&)> onClick` — called on mouseDown with stored chord
    Override: paint, mouseDown, mouseUp, mouseEnter, mouseExit.
    Private members: `Chord chord{}`, `bool isPressed = false`, `bool isHovered = false`.

    Create `src/ui/PadComponent.cpp` — implement PadComponent.
    Include `PadComponent.h`.
    paint(): Draw rounded rectangle (cornerSize 6.0f, reduced 1.0f).
    Colour states (use juce::Colour with hex literals matching the LookAndFeel palette):
    - Normal: Colour(0xff2a2a3a) — slightly lighter than window bg
    - Hovered: Colour(0xff353545)
    - Pressed: Colour(0xff6c8ebf) — accent blue (matches defaultFill in colour scheme)
    Draw 1px border with Colour(0xff4a4a5a).
    Draw chord.name() centred using Font(FontOptions(14.0f)) in Colour(0xffe0e0e0).
    mouseDown: set isPressed=true, repaint, call onClick(chord) if set.
    mouseUp: set isPressed=false, repaint.
    mouseEnter: set isHovered=true, repaint.
    mouseExit: set isHovered=false, isPressed=false, repaint.
  </action>
  <verify>Files created with correct includes and namespace. Compilation verified in Task 2.</verify>
  <done>ChromaticPalette returns exactly 32 Chord values (12 major, 12 minor, 4 dim, 4 aug). PadComponent renders chord name with hover/press visual feedback.</done>
</task>

<task type="auto">
  <name>Task 2: Create GridPanel, integrate into PluginEditor, update build</name>
  <files>
    src/ui/GridPanel.h
    src/ui/GridPanel.cpp
    src/ui/ChordPumperLookAndFeel.h
    src/ui/PluginEditor.h
    src/ui/PluginEditor.cpp
    CMakeLists.txt
  </files>
  <action>
    Create `src/ui/GridPanel.h` — in namespace chordpumper.
    Include `<juce_gui_basics/juce_gui_basics.h>`, `"PadComponent.h"`.
    Class GridPanel : public juce::Component.
    Public: default constructor, override resized().
    Public callback: `std::function<void(const Chord&)> onPadClicked` — Plan 02 will wire this.
    Private: `juce::OwnedArray<PadComponent> pads`.

    Create `src/ui/GridPanel.cpp`.
    Include `"GridPanel.h"`, `"midi/ChromaticPalette.h"`.
    Constructor: call `auto palette = chromaticPalette()`.
    Loop 0–31: create PadComponent via pads.add(new PadComponent()),
    call pad->setChord(palette[i]),
    set pad->onClick to a lambda that forwards to onPadClicked (check if set first),
    call addAndMakeVisible(pad).
    resized(): Build juce::Grid with setGap(Px(4)), 8 columns of Fr(1), 4 rows of Fr(1).
    Loop pads and add GridItem for each. Call grid.performLayout(getLocalBounds()).

    Update `src/ui/ChordPumperLookAndFeel.h`:
    Add a `namespace PadColours` block before the class with inline constexpr juce::uint32 constants:
    background = 0xff2a2a3a, pressed = 0xff6c8ebf, hovered = 0xff353545,
    text = 0xffe0e0e0, border = 0xff4a4a5a.
    These centralise pad colours (PadComponent uses them via Colour() constructor).

    Update `src/ui/PluginEditor.h`:
    Add `#include "GridPanel.h"`. Add `GridPanel gridPanel;` private member after lookAndFeel.

    Update `src/ui/PluginEditor.cpp`:
    In constructor: add `addAndMakeVisible(gridPanel);` before setSize.
    In paint(): replace the centred "ChordPumper v0.1.0" text with a smaller title:
    draw "ChordPumper" in FontOptions(18.0f) at top of window (getLocalBounds().removeFromTop(40), centred).
    In resized(): auto area = getLocalBounds().reduced(10);
    area.removeFromTop(40) for title; gridPanel.setBounds(area).

    Update `CMakeLists.txt`:
    In the `target_sources(ChordPumper PRIVATE ...)` block, add:
    src/ui/PadComponent.cpp and src/ui/GridPanel.cpp.
  </action>
  <verify>Run `cmake --build build --target ChordPumper_Standalone 2>&1 | tail -5` — build succeeds with zero errors. Launch standalone briefly to confirm grid is visible (or just confirm build success).</verify>
  <done>Plugin window shows 8×4 grid of 32 pads, each labeled with its chord name from the chromatic palette. Pads highlight on hover and press. Build compiles cleanly.</done>
</task>

</tasks>

<verification>
- `cmake --build build --target ChordPumper_Standalone` compiles without errors
- Plugin binary exists and can launch
- 32 pad components visible in 8×4 arrangement
- Each pad shows correct chord name (C, C#, D, ..., Caug, Ebaug, Gaug, Bbaug)
- Pads visually respond to mouse hover and click
</verification>

<success_criteria>
- 8×4 grid of 32 labeled chord pads visible in plugin window (GRID-01)
- Grid populated with chromatic palette: 12 major, 12 minor, 4 dim, 4 aug (GRID-02)
- Build compiles cleanly with new source files
- Visual hover/press states working on all pads
</success_criteria>

<output>
After completion, create `.planning/phases/03-playable-grid/03-01-SUMMARY.md`
</output>
